import{j as e,I as d}from"./iconify.Bbb5cklZ.js";import{r as n}from"./index.CaZlGE7t.js";import{u as U}from"./useTranslation.C5VkEOeN.js";import{T as Z}from"./Toast.CfBa7hzp.js";import{u as ee}from"./useToast.BMUEhQbi.js";const te=(t,a)=>{const g=new Date(t),l=Math.abs(new Date().getTime()-g.getTime()),i=Math.floor(l/(1e3*60*60*24)),x=Math.floor(i/365),v=i%365,h=Math.floor(v/30),r=v%30;if(x>0){const u=x>1?a("petList.helpers.age.years"):a("petList.helpers.age.year");if(h>0){const y=h>1?a("petList.helpers.age.months"):a("petList.helpers.age.month");return`${x} ${u}, ${h} ${y}`}else return`${x} ${u}`}else{const u=[];if(h>0){const y=h>1?a("petList.helpers.age.months"):a("petList.helpers.age.month");u.push(`${h} ${y}`)}if(r>0){const y=r>1?a("petList.helpers.age.days"):a("petList.helpers.age.day");u.push(`${r} ${y}`)}return u.length>0?u.join(", "):"0 days"}},re=t=>{switch(t){case"dog":return"ðŸ•";case"cat":return"ðŸ±";case"bird":return"ðŸ¦";default:return"ðŸ¾"}},X=t=>t.name.trim()?t.breed.trim()?t.birth_date?{isValid:!0}:{isValid:!1,error:"La fecha de nacimiento es requerida"}:{isValid:!1,error:"La raza es requerida"}:{isValid:!1,error:"El nombre es requerido"},ae=t=>t.type.startsWith("image/")?t.size>5*1024*1024?{isValid:!1,error:"La imagen no puede superar los 5MB"}:{isValid:!0}:{isValid:!1,error:"Por favor selecciona un archivo de imagen vÃ¡lido"};function se({pet:t,onEdit:a,onDelete:g,onView:o}){const{t:l}=U();return n.useEffect(()=>{if(!document.getElementById("shake-animation")){const i=document.createElement("style");i.id="shake-animation",i.textContent=`
        @keyframes shake {
          0%, 100% { transform: translateX(0) rotate(0deg); }
          10%, 30%, 50%, 70%, 90% { transform: translateX(-2px) rotate(-1deg); }
          20%, 40%, 60%, 80% { transform: translateX(2px) rotate(1deg); }
        }
      `,document.head.appendChild(i)}},[]),e.jsxs("div",{className:"bg-dark-secondary border border-dark-hover rounded-2xl p-6 shadow-lg hover:shadow-xl hover:border-blue-500/30 transition-all duration-300 group",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("div",{className:"w-16 h-16 rounded-xl overflow-hidden shadow-lg group-hover:scale-105 transition-transform",children:[t.photo_url?e.jsx("img",{src:t.photo_url,alt:t.name,className:"w-full h-full object-cover",onError:i=>{i.currentTarget.style.display="none",i.currentTarget.nextElementSibling?.removeAttribute("style")}}):null,e.jsx("div",{className:`flex items-center justify-center w-full h-full bg-gradient-to-r from-blue-500 to-purple-600 text-2xl ${t.photo_url?"hidden":"flex"}`,children:re(t.species)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-dark-primary group-hover:text-blue-400 transition-colors",children:t.name}),e.jsx("p",{className:"text-dark-secondary text-sm",children:t.breed})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:calendar",className:"w-4 h-4 text-orange-400"}),l("petList.card.age")]}),e.jsx("span",{className:"text-dark-primary font-medium text-sm",children:te(t.birth_date,l)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:palette",className:"w-4 h-4 text-pink-400"}),l("petList.card.color")]}),e.jsx("span",{className:"text-dark-primary font-medium text-sm",children:t.color})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:weight",className:"w-4 h-4 text-teal-400"}),l("petList.card.weight")]}),e.jsxs("span",{className:"text-dark-primary font-medium text-sm",children:[t.weight_kg," kg"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:gender-male-female",className:"w-4 h-4 text-indigo-400"}),l("petList.card.gender")]}),e.jsx("span",{className:"text-dark-primary font-medium text-sm",children:t.gender==="male"?l("petList.card.male"):l("petList.card.female")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:medical-bag",className:"w-4 h-4 text-purple-400"}),l("petList.card.neutered")]}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ${t.neutered?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:[e.jsx(d,{icon:t.neutered?"mdi:check":"mdi:close",className:"w-3 h-3"}),t.neutered?l("petList.card.yes"):l("petList.card.no")]})]}),t.microchip&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:chip",className:"w-4 h-4 text-cyan-400"}),l("petList.card.chip")]}),e.jsx("span",{className:"text-dark-primary font-mono text-xs bg-dark-card px-2 py-1 rounded border border-dark-hover",children:t.microchip})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>o(t.id),className:"flex-1 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white py-2 px-3 sm:px-4 rounded-xl text-sm font-medium transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1",title:l("petList.card.viewTitle"),children:[e.jsx(d,{icon:"mdi:eye",className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:l("petList.card.viewButton")})]}),e.jsxs("button",{onClick:()=>a(t),className:"flex-1 bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white py-2 px-3 sm:px-4 rounded-xl text-sm font-medium transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1",title:l("petList.card.editTitle"),children:[e.jsx(d,{icon:"mdi:pencil",className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:l("petList.card.editButton")})]}),e.jsxs("button",{onClick:()=>g(t),className:"flex-1 bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white py-2 px-3 sm:px-4 rounded-xl text-sm font-medium transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1",title:l("petList.card.deleteTitle"),onMouseEnter:i=>{i.currentTarget.style.animation="shake 0.5s ease-in-out infinite"},onMouseLeave:i=>{i.currentTarget.style.animation="none"},children:[e.jsx(d,{icon:"mdi:delete",className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:l("petList.card.deleteButton")})]})]})]})}function O({mode:t,pet:a,onSubmit:g,onChange:o,onCancel:l,onImageUpload:i,uploadingImage:x,submitting:v,error:h}){const{t:r}=U(),u=n.useRef(null),y=s=>{const f=s.target.files?.[0];f&&i(f),s.target.value=""},m=t==="edit",E=m?r("petList.form.editTitle",{name:a.name}):r("petList.form.addTitle"),P=m?"mdi:pencil":"mdi:plus-circle",$=r(m?"petList.form.saveButton":"petList.form.createButton"),C=m?"mdi:content-save":"mdi:plus",D=r(m?"petList.form.savingText":"petList.form.creatingText"),_=m?"from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700":"from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700";return e.jsxs("div",{className:"bg-gradient-card rounded-2xl shadow-xl border border-dark-hover p-8 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-dark-hover",children:[e.jsx(d,{icon:P,className:`w-6 h-6 ${m?"text-blue-400":"text-green-400"}`}),e.jsx("h2",{className:"text-xl font-bold text-dark-primary",children:E})]}),h&&e.jsx("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-600/30 rounded-xl text-red-400",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{icon:"mdi:alert-circle",className:"w-5 h-5"}),h]})}),e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.nameRequired")}),e.jsx("input",{type:"text",value:a.name,onChange:s=>o({name:s.target.value}),required:!0,className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:r("petList.form.namePlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.breedRequired")}),e.jsx("input",{type:"text",value:a.breed,onChange:s=>o({breed:s.target.value}),required:!0,className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:r("petList.form.breedPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.birthDateRequired")}),e.jsx("input",{type:"date",value:a.birth_date,onChange:s=>o({birth_date:s.target.value}),required:!0,className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.color")}),e.jsx("input",{type:"text",value:a.color,onChange:s=>o({color:s.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:r("petList.form.colorPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.weight")}),e.jsx("input",{type:"number",step:"0.1",value:a.weight_kg,onChange:s=>o({weight_kg:m?parseFloat(s.target.value)||0:s.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:r("petList.form.weightPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.species")}),e.jsxs("select",{value:a.species,onChange:s=>o({species:s.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"dog",children:r("petList.form.speciesDog")}),e.jsx("option",{value:"cat",children:r("petList.form.speciesCat")}),e.jsx("option",{value:"bird",children:r("petList.form.speciesBird")}),e.jsx("option",{value:"other",children:r("petList.form.speciesOther")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.gender")}),e.jsxs("select",{value:a.gender,onChange:s=>o({gender:s.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"male",children:r("petList.form.genderMale")}),e.jsx("option",{value:"female",children:r("petList.form.genderFemale")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.size")}),e.jsxs("select",{value:a.size,onChange:s=>o({size:s.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"small",children:r("petList.form.sizeSmall")}),e.jsx("option",{value:"medium",children:r("petList.form.sizeMedium")}),e.jsx("option",{value:"large",children:r("petList.form.sizeLarge")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.neuteredQuestion")}),e.jsxs("select",{value:m?a.neutered===!0||a.neutered===1?"true":"false":a.neutered.toString(),onChange:s=>o({neutered:s.target.value==="true"}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"false",children:r("petList.card.no")}),e.jsx("option",{value:"true",children:r("petList.card.yes")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.chip")}),e.jsx("input",{type:"text",value:a.microchip||"",onChange:s=>o({microchip:s.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:r("petList.form.chipPlaceholder")})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.image")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:a.photo_url||"",onChange:s=>o({photo_url:s.target.value}),placeholder:r("petList.form.imageUrlPlaceholder"),className:"flex-1 px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"}),e.jsx("input",{ref:u,type:"file",accept:"image/*",onChange:y,className:"hidden",disabled:x}),e.jsx("button",{type:"button",onClick:()=>u.current?.click(),disabled:x,className:"px-4 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-xl hover:from-purple-600 hover:to-indigo-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:r("petList.form.uploadImageTitle"),children:x?e.jsx(d,{icon:"mdi:loading",className:"w-5 h-5 animate-spin"}):e.jsx(d,{icon:"mdi:camera",className:"w-5 h-5"})})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:v,className:`px-6 py-3 bg-gradient-to-r ${_} text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2`,children:v?e.jsxs(e.Fragment,{children:[e.jsx(d,{icon:"mdi:loading",className:"w-5 h-5 animate-spin"}),D]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{icon:C,className:"w-5 h-5"}),$]})}),m&&l&&e.jsxs("button",{type:"button",onClick:l,className:"px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:close",className:"w-5 h-5"}),r("petList.form.cancelButton")]})]})]})]})}function le({pet:t,onConfirm:a,onCancel:g,isDeleting:o=!1}){const{t:l}=U();return n.useEffect(()=>{if(!document.getElementById("shake-animation")){const i=document.createElement("style");i.id="shake-animation",i.textContent=`
        @keyframes shake {
          0%, 100% { transform: translateX(0) rotate(0deg); }
          10%, 30%, 50%, 70%, 90% { transform: translateX(-2px) rotate(-1deg); }
          20%, 40%, 60%, 80% { transform: translateX(2px) rotate(1deg); }
        }
      `,document.head.appendChild(i)}},[]),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-gradient-card rounded-2xl shadow-2xl border border-red-600/30 p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-red-600/20 rounded-xl border border-red-600/30",children:e.jsx(d,{icon:"mdi:alert",className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-dark-primary",children:l("petList.deleteModal.title")}),e.jsx("p",{className:"text-dark-secondary text-sm",children:l("petList.deleteModal.subtitle")})]})]}),e.jsx("div",{className:"mb-6 p-4 bg-red-900/20 rounded-xl border border-red-600/30",children:e.jsx("p",{className:"text-dark-primary text-center",children:l("petList.deleteModal.message",{name:t.name})})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:g,disabled:o,className:"flex-1 bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white py-3 px-4 rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(d,{icon:"mdi:close",className:"w-5 h-5"}),l("petList.deleteModal.cancel")]}),e.jsx("button",{onClick:a,disabled:o,className:"flex-1 bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white py-3 px-4 rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onMouseEnter:i=>{o||(i.currentTarget.style.animation="shake 0.5s ease-in-out infinite")},onMouseLeave:i=>{i.currentTarget.style.animation="none"},children:o?e.jsxs(e.Fragment,{children:[e.jsx(d,{icon:"mdi:loading",className:"w-5 h-5 animate-spin"}),l("petList.deleteModal.deleting")]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{icon:"mdi:delete",className:"w-5 h-5"}),l("petList.deleteModal.delete")]})})]})]})})}function ie(){return e.jsxs("div",{className:"min-h-screen bg-dark-primary p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"h-10 w-64 bg-dark-secondary rounded-xl mb-4 animate-pulse"}),e.jsx("div",{className:"h-6 w-96 bg-dark-secondary rounded-lg animate-pulse"})]}),e.jsx("div",{className:"mb-8 text-center",children:e.jsx("div",{className:"h-12 w-48 bg-gradient-to-r from-blue-400 to-purple-400 rounded-xl mx-auto animate-pulse"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((t,a)=>e.jsxs("div",{className:"bg-gradient-card border border-dark-hover rounded-2xl p-6 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-400 rounded-xl animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-6 bg-dark-secondary rounded-lg mb-2 animate-pulse"}),e.jsx("div",{className:"h-4 bg-dark-secondary rounded w-3/4 animate-pulse"})]})]}),e.jsx("div",{className:"space-y-3 mb-6",children:[...Array(4)].map((g,o)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-4 bg-dark-secondary rounded w-1/3 animate-pulse"}),e.jsx("div",{className:"h-4 bg-dark-secondary rounded w-1/4 animate-pulse"})]},o))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-10 bg-blue-500 rounded-xl flex-1 animate-pulse"}),e.jsx("div",{className:"h-10 bg-purple-500 rounded-xl flex-1 animate-pulse"}),e.jsx("div",{className:"h-10 bg-red-500 rounded-xl flex-1 animate-pulse"})]})]},a))})]})}function ne(){return e.jsx("header",{className:"mb-8"})}function oe({onAddPet:t}){const{t:a}=U();return e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ¾"}),e.jsx("h3",{className:"text-xl font-bold text-dark-primary mb-2",children:a("petList.emptyState.title")}),e.jsx("p",{className:"text-dark-secondary mb-6",children:a("petList.emptyState.subtitle")}),e.jsxs("button",{onClick:t,className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl flex items-center gap-2 mx-auto",children:[e.jsx(d,{icon:"mdi:plus",className:"w-5 h-5"}),a("petList.emptyState.addButton")]})]})}const W={name:"",breed:"",birth_date:"",color:"",microchip:"",weight_kg:"",species:"dog",gender:"male",size:"medium",neutered:!1,photo_url:""},F="",z=()=>{const t=localStorage.getItem("authToken"),a={};return t&&(a.Authorization=`Bearer ${t}`),a};function de(t){const[a,g]=n.useState([]),[o,l]=n.useState(!0),[i,x]=n.useState(null),[v,h]=n.useState(!1),[r,u]=n.useState(!1),[y,m]=n.useState(!1),[E,P]=n.useState(!1),[$,C]=n.useState(!1),[D,_]=n.useState(!1),[s,f]=n.useState(null),[w,M]=n.useState(null),[A,T]=n.useState(!1),[k,B]=n.useState(W),N=n.useCallback(async()=>{try{l(!0);const c=await fetch(`${F}/api/pets`,{headers:z()});if(!c.ok)throw new Error("Error al cargar mascotas");const p=await c.json();g(p)}catch(c){x(c instanceof Error?c.message:"Error desconocido")}finally{l(!1)}},[]),q=n.useCallback(async c=>{c.preventDefault();const p=X(k);if(!p.isValid){t(p.error,"error");return}try{h(!0);const j={...k,weight_kg:parseFloat(k.weight_kg)||0},L=await(await fetch(`${F}/api/pets`,{method:"POST",headers:{...z(),"Content-Type":"application/json"},body:JSON.stringify(j)})).json();L.success?(B(W),await N(),_(!1),t("Mascota creada exitosamente","success")):t(L.message||"Error al crear mascota","error")}catch(j){t(j instanceof Error?j.message:"Error al crear mascota","error")}finally{h(!1)}},[k,t,N]),R=n.useCallback(async c=>{if(c.preventDefault(),!s)return;const p=X(s);if(!p.isValid){t(p.error,"error");return}try{u(!0);const j={...s,weight_kg:parseFloat(s.weight_kg.toString())||0},L=await(await fetch(`${F}/api/pets/${s.id}`,{method:"PUT",headers:{...z(),"Content-Type":"application/json"},body:JSON.stringify(j)})).json();L.success?(f(null),await N(),t("Mascota actualizada exitosamente","success")):t(L.message||"Error al actualizar mascota","error")}catch(j){t(j instanceof Error?j.message:"Error al actualizar mascota","error")}finally{u(!1)}},[s,t,N]),b=n.useCallback(async()=>{if(w)try{m(!0);const p=await(await fetch(`${F}/api/pets/${w.id}`,{method:"DELETE",headers:z()})).json();p.success?(await N(),t(`${w.name} eliminado exitosamente`,"success"),s&&s.id===w.id&&f(null)):t(p.message||"Error al eliminar mascota","error")}catch(c){t(c instanceof Error?c.message:"Error al eliminar mascota","error")}finally{m(!1),T(!1),M(null)}},[w,s,t,N]),H=n.useCallback(async(c,p=!1)=>{if(!c)return;const j=ae(c);if(!j.isValid){t(j.error,"error");return}try{p?C(!0):P(!0);const S=new FormData;S.append("image",c);const L=await fetch(`${F}/api/upload/image`,{method:"POST",headers:z(),body:S});if(!L.ok)throw new Error("Error al subir la imagen");const V=await L.json();if(V.success){let I=V.url||V.imageUrl;I&&I.startsWith("/")&&(I=window.location.origin+I),p&&s?f({...s,photo_url:I}):B({...k,photo_url:I}),t("Imagen subida exitosamente","success")}else throw new Error(V.message||"Error al subir la imagen")}catch(S){t(S instanceof Error?S.message:"Error al subir la imagen","error")}finally{p?C(!1):P(!1)}},[s,k,t]),J=n.useCallback(c=>{f(c),x(null)},[]),Q=n.useCallback(()=>{f(null)},[]),Y=n.useCallback(c=>{M(c),T(!0)},[]),G=n.useCallback(c=>{window.location.href=`/?pet=${c}`},[]),K=n.useCallback(()=>{T(!1),M(null)},[]);return{pets:a,loading:o,error:i,creating:v,updating:r,deleting:y,uploadingImage:E,uploadingImageEdit:$,showNewPetForm:D,editingPet:s,petToDelete:w,showDeleteModal:A,newPet:k,setError:x,setShowNewPetForm:_,setNewPet:B,setEditingPet:f,fetchPets:N,handleCreatePet:q,handleUpdatePet:R,confirmDeletePet:b,handleImageUpload:H,handleEditPet:J,handleCancelEdit:Q,handleDeletePetClick:Y,handleViewPet:G,handleCancelDelete:K}}function pe(){const{t}=U(),{toast:a,showToast:g,hideToast:o}=ee(),{pets:l,loading:i,error:x,creating:v,updating:h,deleting:r,uploadingImage:u,uploadingImageEdit:y,showNewPetForm:m,editingPet:E,petToDelete:P,showDeleteModal:$,newPet:C,setShowNewPetForm:D,setNewPet:_,setEditingPet:s,fetchPets:f,handleCreatePet:w,handleUpdatePet:M,confirmDeletePet:A,handleImageUpload:T,handleEditPet:k,handleCancelEdit:B,handleDeletePetClick:N,handleViewPet:q,handleCancelDelete:R}=de(g);return n.useEffect(()=>{f()},[f]),i?e.jsx(ie,{}):e.jsxs("div",{className:"min-h-screen p-6",children:[e.jsx(ne,{}),e.jsx("div",{className:"mb-8",children:e.jsxs("button",{onClick:()=>D(!m),className:`flex items-center gap-3 px-6 py-3 rounded-xl font-semibold transition-all duration-200 shadow-lg hover:shadow-xl ${m?"bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white":"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white"}`,children:[e.jsx(d,{icon:m?"mdi:close":"mdi:plus",className:"w-5 h-5"}),t(m?"petList.main.cancelButton":"petList.main.newPetButton")]})}),m&&e.jsx(O,{mode:"create",pet:C,onSubmit:w,onChange:b=>_({...C,...b}),onImageUpload:b=>T(b,!1),uploadingImage:u,submitting:v,error:x}),E&&e.jsx(O,{mode:"edit",pet:E,onSubmit:M,onChange:b=>s({...E,...b}),onCancel:B,onImageUpload:b=>T(b,!0),uploadingImage:y,submitting:h}),e.jsxs("div",{className:"bg-gradient-card rounded-2xl shadow-xl border border-dark-hover p-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{icon:"mdi:heart",className:"w-6 h-6 text-red-400"}),e.jsx("h2",{className:"text-xl font-bold text-dark-primary",children:t("petList.main.title",{count:l.length})})]})}),l.length===0?e.jsx(oe,{onAddPet:()=>D(!0)}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(b=>e.jsx(se,{pet:b,onEdit:k,onDelete:N,onView:q},b.id))})]}),$&&P&&e.jsx(le,{pet:P,onConfirm:A,onCancel:R,isDeleting:r}),a&&e.jsx(Z,{toast:a,onClose:o})]})}export{pe as default};

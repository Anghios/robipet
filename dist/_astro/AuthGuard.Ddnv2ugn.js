import{j as e,u as p,I as x}from"./useTranslation.CTbK4-hk.js";import{r as n}from"./index.CaZlGE7t.js";import b from"./Footer.BuWoFfy-.js";function N({children:m}){const[t,a]=n.useState(!1),[h,c]=n.useState(!0),[f,r]=n.useState(null);n.useEffect(()=>{(async()=>{try{const l=localStorage.getItem("user");if(l){const s=JSON.parse(l);try{const o=await fetch("/api/verify-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s.id})});o.ok&&(await o.json()).valid?(r(s),a(!0)):(localStorage.removeItem("user"),a(!1),r(null))}catch{r(s),a(!0)}}else a(!1)}catch{a(!1)}finally{setTimeout(()=>c(!1),150)}})();const d=setInterval(async()=>{const l=localStorage.getItem("user");if(l&&t)try{const s=JSON.parse(l),o=await fetch("/api/verify-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s.id})});o.ok&&((await o.json()).valid||(localStorage.removeItem("user"),a(!1),r(null)))}catch(s){console.warn("Error verificando sesiÃ³n:",s)}},3e4);return()=>clearInterval(d)},[t]);const u=async(i,d)=>{try{const s=await(await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:d})})).json();return s.success?(localStorage.setItem("user",JSON.stringify(s.user)),r(s.user),a(!0),!0):!1}catch{return!1}};return h?e.jsxs("div",{className:"min-h-screen bg-dark-primary",children:[e.jsx("nav",{className:"bg-dark-card shadow-lg border-b border-dark-hover",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[e.jsx("div",{className:"h-8 w-8 bg-gray-700 rounded-full animate-pulse"}),e.jsx("div",{className:"ml-3 h-6 w-24 bg-gray-700 rounded animate-pulse"})]}),e.jsx("div",{className:"hidden md:ml-6 md:flex md:space-x-8",children:[1,2,3].map(i=>e.jsx("div",{className:"h-4 w-16 bg-gray-700 rounded animate-pulse my-6"},i))})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("div",{className:"h-8 w-8 bg-gray-700 rounded-full animate-pulse"})})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-8 p-8 bg-gray-800 rounded-2xl animate-pulse",children:[e.jsx("div",{className:"h-10 w-64 bg-gray-700 rounded mb-4"}),e.jsx("div",{className:"h-6 w-96 bg-gray-700 rounded"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(i=>e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 w-3/4 bg-gray-700 rounded mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 w-full bg-gray-700 rounded"}),e.jsx("div",{className:"h-3 w-5/6 bg-gray-700 rounded"})]})]},i))})]})]}):t?e.jsx(e.Fragment,{children:m}):e.jsx(j,{onLogin:u})}function j({onLogin:m}){const{t}=p(),[a,h]=n.useState(""),[c,f]=n.useState(""),[r,u]=n.useState(!1),[i,d]=n.useState(""),l=async s=>{s.preventDefault(),u(!0),d(""),await m(a,c)||d(t("auth.invalidCredentials")),u(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 flex flex-col",children:[e.jsx("div",{className:"flex-grow flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/20 p-12",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"flex items-center justify-center w-24 h-24 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full mx-auto mb-6 overflow-hidden shadow-lg",children:e.jsx("img",{src:"/logo.png",alt:"Robipet Logo",className:"w-16 h-16 object-contain"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-3",children:t("auth.welcome")})]}),i&&e.jsx("div",{className:"mb-8 p-4 bg-red-500/20 backdrop-blur border border-red-400/30 rounded-xl",children:e.jsx("p",{className:"text-red-200 text-sm text-center font-medium",children:i})}),e.jsxs("form",{onSubmit:l,className:"space-y-6",children:[e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(x,{icon:"mdi:account-outline",className:"w-6 h-6 text-white/50"})}),e.jsx("input",{type:"text",value:a,onChange:s=>h(s.target.value),required:!0,className:"w-full pl-12 pr-5 py-4 bg-white/10 backdrop-blur border border-white/20 text-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all placeholder-white/50 text-lg",placeholder:t("auth.userPlaceholder"),disabled:r})]})}),e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(x,{icon:"mdi:lock-outline",className:"w-6 h-6 text-white/50"})}),e.jsx("input",{type:"password",value:c,onChange:s=>f(s.target.value),required:!0,className:"w-full pl-12 pr-5 py-4 bg-white/10 backdrop-blur border border-white/20 text-white rounded-xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all placeholder-white/50 text-lg",placeholder:t("auth.passwordPlaceholder"),disabled:r})]})}),e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 px-6 rounded-xl font-semibold text-lg hover:shadow-xl hover:scale-105 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none shadow-lg",children:r?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white mr-3"}),t("auth.loggingIn")]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(x,{icon:"mdi:login",className:"w-5 h-5"}),t("auth.loginButton")]})})]})]})})}),e.jsx(b,{})]})}export{N as default};

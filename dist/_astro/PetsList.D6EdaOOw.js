import{u as B,j as e,I as d}from"./useTranslation.Bj4lSKMn.js";import{r as n}from"./index.CaZlGE7t.js";import{T as K}from"./Toast.C4bjx4XO.js";import{u as Z}from"./useToast.BMUEhQbi.js";const ee=(t,s)=>{const f=new Date(t),l=Math.abs(new Date().getTime()-f.getTime()),i=Math.floor(l/(1e3*60*60*24)),x=Math.floor(i/365),v=i%365,h=Math.floor(v/30),r=v%30;if(x>0){const u=x>1?s("petList.helpers.age.years"):s("petList.helpers.age.year");if(h>0){const y=h>1?s("petList.helpers.age.months"):s("petList.helpers.age.month");return`${x} ${u}, ${h} ${y}`}else return`${x} ${u}`}else{const u=[];if(h>0){const y=h>1?s("petList.helpers.age.months"):s("petList.helpers.age.month");u.push(`${h} ${y}`)}if(r>0){const y=r>1?s("petList.helpers.age.days"):s("petList.helpers.age.day");u.push(`${r} ${y}`)}return u.length>0?u.join(", "):"0 days"}},te=t=>{switch(t){case"dog":return"ðŸ•";case"cat":return"ðŸ±";case"bird":return"ðŸ¦";default:return"ðŸ¾"}},R=t=>t.name.trim()?t.breed.trim()?t.birth_date?{isValid:!0}:{isValid:!1,error:"La fecha de nacimiento es requerida"}:{isValid:!1,error:"La raza es requerida"}:{isValid:!1,error:"El nombre es requerido"},re=t=>t.type.startsWith("image/")?t.size>5*1024*1024?{isValid:!1,error:"La imagen no puede superar los 5MB"}:{isValid:!0}:{isValid:!1,error:"Por favor selecciona un archivo de imagen vÃ¡lido"};function ae({pet:t,onEdit:s,onDelete:f,onView:o}){const{t:l}=B();return n.useEffect(()=>{if(!document.getElementById("shake-animation")){const i=document.createElement("style");i.id="shake-animation",i.textContent=`
        @keyframes shake {
          0%, 100% { transform: translateX(0) rotate(0deg); }
          10%, 30%, 50%, 70%, 90% { transform: translateX(-2px) rotate(-1deg); }
          20%, 40%, 60%, 80% { transform: translateX(2px) rotate(1deg); }
        }
      `,document.head.appendChild(i)}},[]),e.jsxs("div",{className:"bg-dark-secondary border border-dark-hover rounded-2xl p-6 shadow-lg hover:shadow-xl hover:border-blue-500/30 transition-all duration-300 group",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("div",{className:"w-16 h-16 rounded-xl overflow-hidden shadow-lg group-hover:scale-105 transition-transform",children:[t.photo_url?e.jsx("img",{src:t.photo_url,alt:t.name,className:"w-full h-full object-cover",onError:i=>{i.currentTarget.style.display="none",i.currentTarget.nextElementSibling?.removeAttribute("style")}}):null,e.jsx("div",{className:`flex items-center justify-center w-full h-full bg-gradient-to-r from-blue-500 to-purple-600 text-2xl ${t.photo_url?"hidden":"flex"}`,children:te(t.species)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-dark-primary group-hover:text-blue-400 transition-colors",children:t.name}),e.jsx("p",{className:"text-dark-secondary text-sm",children:t.breed})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:calendar",className:"w-4 h-4 text-orange-400"}),l("petList.card.age")]}),e.jsx("span",{className:"text-dark-primary font-medium text-sm",children:ee(t.birth_date,l)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:palette",className:"w-4 h-4 text-pink-400"}),l("petList.card.color")]}),e.jsx("span",{className:"text-dark-primary font-medium text-sm",children:t.color})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:weight",className:"w-4 h-4 text-teal-400"}),l("petList.card.weight")]}),e.jsxs("span",{className:"text-dark-primary font-medium text-sm",children:[t.weight_kg," kg"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:gender-male-female",className:"w-4 h-4 text-indigo-400"}),l("petList.card.gender")]}),e.jsx("span",{className:"text-dark-primary font-medium text-sm",children:t.gender==="male"?l("petList.card.male"):l("petList.card.female")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:medical-bag",className:"w-4 h-4 text-purple-400"}),l("petList.card.neutered")]}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ${t.neutered?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:[e.jsx(d,{icon:t.neutered?"mdi:check":"mdi:close",className:"w-3 h-3"}),t.neutered?l("petList.card.yes"):l("petList.card.no")]})]}),t.microchip&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-dark-secondary text-sm flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:chip",className:"w-4 h-4 text-cyan-400"}),l("petList.card.chip")]}),e.jsx("span",{className:"text-dark-primary font-mono text-xs bg-dark-card px-2 py-1 rounded border border-dark-hover",children:t.microchip})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>o(t.id),className:"flex-1 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white py-2 px-3 sm:px-4 rounded-xl text-sm font-medium transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1",title:l("petList.card.viewTitle"),children:[e.jsx(d,{icon:"mdi:eye",className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:l("petList.card.viewButton")})]}),e.jsxs("button",{onClick:()=>s(t),className:"flex-1 bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white py-2 px-3 sm:px-4 rounded-xl text-sm font-medium transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1",title:l("petList.card.editTitle"),children:[e.jsx(d,{icon:"mdi:pencil",className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:l("petList.card.editButton")})]}),e.jsxs("button",{onClick:()=>f(t),className:"flex-1 bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white py-2 px-3 sm:px-4 rounded-xl text-sm font-medium transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1",title:l("petList.card.deleteTitle"),onMouseEnter:i=>{i.currentTarget.style.animation="shake 0.5s ease-in-out infinite"},onMouseLeave:i=>{i.currentTarget.style.animation="none"},children:[e.jsx(d,{icon:"mdi:delete",className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:l("petList.card.deleteButton")})]})]})]})}function X({mode:t,pet:s,onSubmit:f,onChange:o,onCancel:l,onImageUpload:i,uploadingImage:x,submitting:v,error:h}){const{t:r}=B(),u=n.useRef(null),y=a=>{const g=a.target.files?.[0];g&&i(g),a.target.value=""},m=t==="edit",E=m?r("petList.form.editTitle",{name:s.name}):r("petList.form.addTitle"),P=m?"mdi:pencil":"mdi:plus-circle",I=r(m?"petList.form.saveButton":"petList.form.createButton"),C=m?"mdi:content-save":"mdi:plus",D=r(m?"petList.form.savingText":"petList.form.creatingText"),_=m?"from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700":"from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700";return e.jsxs("div",{className:"bg-gradient-card rounded-2xl shadow-xl border border-dark-hover p-8 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-dark-hover",children:[e.jsx(d,{icon:P,className:`w-6 h-6 ${m?"text-blue-400":"text-green-400"}`}),e.jsx("h2",{className:"text-xl font-bold text-dark-primary",children:E})]}),h&&e.jsx("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-600/30 rounded-xl text-red-400",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{icon:"mdi:alert-circle",className:"w-5 h-5"}),h]})}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.nameRequired")}),e.jsx("input",{type:"text",value:s.name,onChange:a=>o({name:a.target.value}),required:!0,className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:r("petList.form.namePlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.breedRequired")}),e.jsx("input",{type:"text",value:s.breed,onChange:a=>o({breed:a.target.value}),required:!0,className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:r("petList.form.breedPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.birthDateRequired")}),e.jsx("input",{type:"date",value:s.birth_date,onChange:a=>o({birth_date:a.target.value}),required:!0,className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.color")}),e.jsx("input",{type:"text",value:s.color,onChange:a=>o({color:a.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:r("petList.form.colorPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.weight")}),e.jsx("input",{type:"number",step:"0.1",value:s.weight_kg,onChange:a=>o({weight_kg:m?parseFloat(a.target.value)||0:a.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:r("petList.form.weightPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.species")}),e.jsxs("select",{value:s.species,onChange:a=>o({species:a.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"dog",children:r("petList.form.speciesDog")}),e.jsx("option",{value:"cat",children:r("petList.form.speciesCat")}),e.jsx("option",{value:"bird",children:r("petList.form.speciesBird")}),e.jsx("option",{value:"other",children:r("petList.form.speciesOther")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.gender")}),e.jsxs("select",{value:s.gender,onChange:a=>o({gender:a.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"male",children:r("petList.form.genderMale")}),e.jsx("option",{value:"female",children:r("petList.form.genderFemale")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.size")}),e.jsxs("select",{value:s.size,onChange:a=>o({size:a.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"small",children:r("petList.form.sizeSmall")}),e.jsx("option",{value:"medium",children:r("petList.form.sizeMedium")}),e.jsx("option",{value:"large",children:r("petList.form.sizeLarge")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.neuteredQuestion")}),e.jsxs("select",{value:m?s.neutered===!0||s.neutered===1?"true":"false":s.neutered.toString(),onChange:a=>o({neutered:a.target.value==="true"}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:[e.jsx("option",{value:"false",children:r("petList.card.no")}),e.jsx("option",{value:"true",children:r("petList.card.yes")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.chip")}),e.jsx("input",{type:"text",value:s.microchip||"",onChange:a=>o({microchip:a.target.value}),className:"w-full px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:r("petList.form.chipPlaceholder")})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-dark-primary font-medium mb-2 text-sm",children:r("petList.form.image")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:s.photo_url||"",onChange:a=>o({photo_url:a.target.value}),placeholder:r("petList.form.imageUrlPlaceholder"),className:"flex-1 px-4 py-3 bg-dark-card border border-dark-hover rounded-xl text-dark-primary placeholder:text-dark-secondary focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"}),e.jsx("input",{ref:u,type:"file",accept:"image/*",onChange:y,className:"hidden",disabled:x}),e.jsx("button",{type:"button",onClick:()=>u.current?.click(),disabled:x,className:"px-4 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-xl hover:from-purple-600 hover:to-indigo-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:r("petList.form.uploadImageTitle"),children:x?e.jsx(d,{icon:"mdi:loading",className:"w-5 h-5 animate-spin"}):e.jsx(d,{icon:"mdi:camera",className:"w-5 h-5"})})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:v,className:`px-6 py-3 bg-gradient-to-r ${_} text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2`,children:v?e.jsxs(e.Fragment,{children:[e.jsx(d,{icon:"mdi:loading",className:"w-5 h-5 animate-spin"}),D]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{icon:C,className:"w-5 h-5"}),I]})}),m&&l&&e.jsxs("button",{type:"button",onClick:l,className:"px-6 py-3 bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl flex items-center gap-2",children:[e.jsx(d,{icon:"mdi:close",className:"w-5 h-5"}),r("petList.form.cancelButton")]})]})]})]})}function se({pet:t,onConfirm:s,onCancel:f,isDeleting:o=!1}){const{t:l}=B();return n.useEffect(()=>{if(!document.getElementById("shake-animation")){const i=document.createElement("style");i.id="shake-animation",i.textContent=`
        @keyframes shake {
          0%, 100% { transform: translateX(0) rotate(0deg); }
          10%, 30%, 50%, 70%, 90% { transform: translateX(-2px) rotate(-1deg); }
          20%, 40%, 60%, 80% { transform: translateX(2px) rotate(1deg); }
        }
      `,document.head.appendChild(i)}},[]),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-gradient-card rounded-2xl shadow-2xl border border-red-600/30 p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-red-600/20 rounded-xl border border-red-600/30",children:e.jsx(d,{icon:"mdi:alert",className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-dark-primary",children:l("petList.deleteModal.title")}),e.jsx("p",{className:"text-dark-secondary text-sm",children:l("petList.deleteModal.subtitle")})]})]}),e.jsx("div",{className:"mb-6 p-4 bg-red-900/20 rounded-xl border border-red-600/30",children:e.jsx("p",{className:"text-dark-primary text-center",children:l("petList.deleteModal.message",{name:t.name})})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:f,disabled:o,className:"flex-1 bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white py-3 px-4 rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(d,{icon:"mdi:close",className:"w-5 h-5"}),l("petList.deleteModal.cancel")]}),e.jsx("button",{onClick:s,disabled:o,className:"flex-1 bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white py-3 px-4 rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",onMouseEnter:i=>{o||(i.currentTarget.style.animation="shake 0.5s ease-in-out infinite")},onMouseLeave:i=>{i.currentTarget.style.animation="none"},children:o?e.jsxs(e.Fragment,{children:[e.jsx(d,{icon:"mdi:loading",className:"w-5 h-5 animate-spin"}),l("petList.deleteModal.deleting")]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{icon:"mdi:delete",className:"w-5 h-5"}),l("petList.deleteModal.delete")]})})]})]})})}function le(){return e.jsxs("div",{className:"min-h-screen bg-dark-primary p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"h-10 w-64 bg-dark-secondary rounded-xl mb-4 animate-pulse"}),e.jsx("div",{className:"h-6 w-96 bg-dark-secondary rounded-lg animate-pulse"})]}),e.jsx("div",{className:"mb-8 text-center",children:e.jsx("div",{className:"h-12 w-48 bg-gradient-to-r from-blue-400 to-purple-400 rounded-xl mx-auto animate-pulse"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((t,s)=>e.jsxs("div",{className:"bg-gradient-card border border-dark-hover rounded-2xl p-6 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-400 to-purple-400 rounded-xl animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-6 bg-dark-secondary rounded-lg mb-2 animate-pulse"}),e.jsx("div",{className:"h-4 bg-dark-secondary rounded w-3/4 animate-pulse"})]})]}),e.jsx("div",{className:"space-y-3 mb-6",children:[...Array(4)].map((f,o)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-4 bg-dark-secondary rounded w-1/3 animate-pulse"}),e.jsx("div",{className:"h-4 bg-dark-secondary rounded w-1/4 animate-pulse"})]},o))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-10 bg-blue-500 rounded-xl flex-1 animate-pulse"}),e.jsx("div",{className:"h-10 bg-purple-500 rounded-xl flex-1 animate-pulse"}),e.jsx("div",{className:"h-10 bg-red-500 rounded-xl flex-1 animate-pulse"})]})]},s))})]})}function ie(){return e.jsx("header",{className:"mb-8"})}function ne({onAddPet:t}){const{t:s}=B();return e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ¾"}),e.jsx("h3",{className:"text-xl font-bold text-dark-primary mb-2",children:s("petList.emptyState.title")}),e.jsx("p",{className:"text-dark-secondary mb-6",children:s("petList.emptyState.subtitle")}),e.jsxs("button",{onClick:t,className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl flex items-center gap-2 mx-auto",children:[e.jsx(d,{icon:"mdi:plus",className:"w-5 h-5"}),s("petList.emptyState.addButton")]})]})}const O={name:"",breed:"",birth_date:"",color:"",microchip:"",weight_kg:"",species:"dog",gender:"male",size:"medium",neutered:!1,photo_url:""},F="http://localhost:8081";function oe(t){const[s,f]=n.useState([]),[o,l]=n.useState(!0),[i,x]=n.useState(null),[v,h]=n.useState(!1),[r,u]=n.useState(!1),[y,m]=n.useState(!1),[E,P]=n.useState(!1),[I,C]=n.useState(!1),[D,_]=n.useState(!1),[a,g]=n.useState(null),[w,M]=n.useState(null),[z,T]=n.useState(!1),[N,$]=n.useState(O),k=n.useCallback(async()=>{try{l(!0);const c=await fetch(`${F}/api/pets`);if(!c.ok)throw new Error("Error al cargar mascotas");const p=await c.json();f(p)}catch(c){x(c instanceof Error?c.message:"Error desconocido")}finally{l(!1)}},[]),V=n.useCallback(async c=>{c.preventDefault();const p=R(N);if(!p.isValid){t(p.error,"error");return}try{h(!0);const j={...N,weight_kg:parseFloat(N.weight_kg)||0},L=await(await fetch(`${F}/api/pets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)})).json();L.success?($(O),await k(),_(!1),t("Mascota creada exitosamente","success")):t(L.message||"Error al crear mascota","error")}catch(j){t(j instanceof Error?j.message:"Error al crear mascota","error")}finally{h(!1)}},[N,t,k]),A=n.useCallback(async c=>{if(c.preventDefault(),!a)return;const p=R(a);if(!p.isValid){t(p.error,"error");return}try{u(!0);const j={...a,weight_kg:parseFloat(a.weight_kg.toString())||0},L=await(await fetch(`${F}/api/pets/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)})).json();L.success?(g(null),await k(),t("Mascota actualizada exitosamente","success")):t(L.message||"Error al actualizar mascota","error")}catch(j){t(j instanceof Error?j.message:"Error al actualizar mascota","error")}finally{u(!1)}},[a,t,k]),b=n.useCallback(async()=>{if(w)try{m(!0);const p=await(await fetch(`${F}/api/pets/${w.id}`,{method:"DELETE"})).json();p.success?(await k(),t(`${w.name} eliminado exitosamente`,"success"),a&&a.id===w.id&&g(null)):t(p.message||"Error al eliminar mascota","error")}catch(c){t(c instanceof Error?c.message:"Error al eliminar mascota","error")}finally{m(!1),T(!1),M(null)}},[w,a,t,k]),J=n.useCallback(async(c,p=!1)=>{if(!c)return;const j=re(c);if(!j.isValid){t(j.error,"error");return}try{p?C(!0):P(!0);const S=new FormData;S.append("image",c);const L=await fetch(`${F}/api/upload/image`,{method:"POST",body:S});if(!L.ok)throw new Error("Error al subir la imagen");const U=await L.json();if(U.success){const q=U.url||U.imageUrl;p&&a?g({...a,photo_url:q}):$({...N,photo_url:q}),t("Imagen subida exitosamente","success")}else throw new Error(U.message||"Error al subir la imagen")}catch(S){t(S instanceof Error?S.message:"Error al subir la imagen","error")}finally{p?C(!1):P(!1)}},[a,N,t]),W=n.useCallback(c=>{g(c),x(null)},[]),H=n.useCallback(()=>{g(null)},[]),Q=n.useCallback(c=>{M(c),T(!0)},[]),Y=n.useCallback(c=>{window.location.href=`/?pet=${c}`},[]),G=n.useCallback(()=>{T(!1),M(null)},[]);return{pets:s,loading:o,error:i,creating:v,updating:r,deleting:y,uploadingImage:E,uploadingImageEdit:I,showNewPetForm:D,editingPet:a,petToDelete:w,showDeleteModal:z,newPet:N,setError:x,setShowNewPetForm:_,setNewPet:$,setEditingPet:g,fetchPets:k,handleCreatePet:V,handleUpdatePet:A,confirmDeletePet:b,handleImageUpload:J,handleEditPet:W,handleCancelEdit:H,handleDeletePetClick:Q,handleViewPet:Y,handleCancelDelete:G}}function xe(){const{t}=B(),{toast:s,showToast:f,hideToast:o}=Z(),{pets:l,loading:i,error:x,creating:v,updating:h,deleting:r,uploadingImage:u,uploadingImageEdit:y,showNewPetForm:m,editingPet:E,petToDelete:P,showDeleteModal:I,newPet:C,setShowNewPetForm:D,setNewPet:_,setEditingPet:a,fetchPets:g,handleCreatePet:w,handleUpdatePet:M,confirmDeletePet:z,handleImageUpload:T,handleEditPet:N,handleCancelEdit:$,handleDeletePetClick:k,handleViewPet:V,handleCancelDelete:A}=oe(f);return n.useEffect(()=>{g()},[g]),i?e.jsx(le,{}):e.jsxs("div",{className:"min-h-screen p-6",children:[e.jsx(ie,{}),e.jsx("div",{className:"mb-8",children:e.jsxs("button",{onClick:()=>D(!m),className:`flex items-center gap-3 px-6 py-3 rounded-xl font-semibold transition-all duration-200 shadow-lg hover:shadow-xl ${m?"bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white":"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white"}`,children:[e.jsx(d,{icon:m?"mdi:close":"mdi:plus",className:"w-5 h-5"}),t(m?"petList.main.cancelButton":"petList.main.newPetButton")]})}),m&&e.jsx(X,{mode:"create",pet:C,onSubmit:w,onChange:b=>_({...C,...b}),onImageUpload:b=>T(b,!1),uploadingImage:u,submitting:v,error:x}),E&&e.jsx(X,{mode:"edit",pet:E,onSubmit:M,onChange:b=>a({...E,...b}),onCancel:$,onImageUpload:b=>T(b,!0),uploadingImage:y,submitting:h}),e.jsxs("div",{className:"bg-gradient-card rounded-2xl shadow-xl border border-dark-hover p-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{icon:"mdi:heart",className:"w-6 h-6 text-red-400"}),e.jsx("h2",{className:"text-xl font-bold text-dark-primary",children:t("petList.main.title",{count:l.length})})]})}),l.length===0?e.jsx(ne,{onAddPet:()=>D(!0)}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(b=>e.jsx(ae,{pet:b,onEdit:N,onDelete:k,onView:V},b.id))})]}),I&&P&&e.jsx(se,{pet:P,onConfirm:z,onCancel:A,isDeleting:r}),s&&e.jsx(K,{toast:s,onClose:o})]})}export{xe as default};
